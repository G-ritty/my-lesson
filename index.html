<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>å°å°æ•°å­—è®¾è®¡å¸ˆ Â· ç”µå­è´ºå¡å¯¼å­¦æ¡ˆ</title>

<!-- å¡é€šå­—ä½“ -->
<link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">

<!-- PDF å¯¼å‡ºä¾èµ– -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

<style>
body {
  font-family: "ZCOOL KuaiLe", sans-serif;
  background: linear-gradient(#d9f7ff, #fff);
  margin: 0;
  padding: 20px;
}

h1 {
  text-align: center;
  color: #ff6b6b;
}

.section {
  background: #ffffff;
  border-radius: 20px;
  padding: 20px;
  margin: 20px auto;
  max-width: 900px;
  box-shadow: 0 6px 12px rgba(0,0,0,0.1);
}

textarea, input[type="text"] {
  width: 100%;
  border-radius: 10px;
  padding: 10px;
  border: 2px solid #74c0fc;
  font-size: 16px;
}

input[type="file"] {
  margin-top: 10px;
}

button {
  background: #4dabf7;
  color: white;
  border: none;
  border-radius: 30px;
  padding: 12px 25px;
  font-size: 18px;
  cursor: pointer;
}

button:hover {
  background: #339af0;
}

/* æ™ºèƒ½ä½“ */
#botIcon {
  position: fixed;
  right: 20px;
  bottom: 20px;
  width: 70px;
  height: 70px;
  background: #ffd43b;
  border-radius: 50%;
  font-size: 36px;
  text-align: center;
  line-height: 70px;
  cursor: pointer;
}

#chatBox {
  display: none;
  position: fixed;
  right: 20px;
  bottom: 100px;
  width: 300px;
  background: white;
  border-radius: 15px;
  box-shadow: 0 0 15px rgba(0,0,0,.2);
}

#chatLog {
  height: 200px;
  overflow-y: auto;
  padding: 10px;
  font-size: 14px;
}

#chatInput {
  width: 100%;
  border: none;
  border-top: 1px solid #ccc;
  padding: 10px;
}
</style>
</head>

<body>

<h1>ğŸ¨ å°å°æ•°å­—è®¾è®¡å¸ˆ Â· æˆ‘çš„ç¬¬ä¸€å¼ ç”µå­è´ºå¡</h1>

<div id="content">

<div class="section">
<h2>ç¬¬ä¸€å…³ï¼šè®¤è¯†æ–°æœ‹å‹</h2>
<textarea placeholder="æˆ‘è®¤è¯†çš„å·¥å…·æœ‰â€¦â€¦"></textarea>
</div>

<div class="section">
<h2>ç¬¬äºŒå…³ï¼šæˆ‘çš„ç¥ç¦è¯­</h2>
<input type="text" placeholder="è¯·è¾“å…¥ä½ çš„ç¥ç¦è¯­">
</div>

<div class="section">
<h2>ç¬¬ä¸‰å…³ï¼šè£…æ‰®è´ºå¡</h2>
<input type="file" accept="image/*" multiple>
</div>

<div class="section">
<h2>ç¬¬å››å…³ï¼šå±•ç¤ºä¸åˆ†äº«</h2>
<textarea placeholder="æˆ‘çš„è´ºå¡é€ç»™è°ï¼Ÿæˆ‘æœ€å–œæ¬¢çš„åœ°æ–¹æ˜¯â€¦â€¦"></textarea>
</div>

<div class="section">
<h2>ğŸ¤– æˆ‘å’Œæ™ºèƒ½ä½“çš„å¯¹è¯</h2>
<div id="chatRecord"></div>
</div>

</div>

<div style="text-align:center">
<button onclick="exportPDF()">ğŸ“„ å¯¼å‡ºæˆ‘çš„å­¦ä¹ æˆæœ PDF</button>
</div>

<!-- æ™ºèƒ½ä½“ -->
<div id="botIcon" onclick="toggleChat()">ğŸ¤–</div>

<div id="chatBox">
  <div id="chatLog"></div>
  <input id="chatInput" placeholder="é—®æˆ‘é—®é¢˜å§ï¼" onkeydown="sendChat(event)">
</div>

<script>
const API_KEY = "sk-56abaf7300b54705853cba2b1365aeed";
const APP_ID = "b02ae061efb14b1fb62db5fc6792bccd";

function toggleChat(){
  chatBox.style.display = chatBox.style.display === "none" ? "block" : "none";
}

async function sendChat(e){
  if(e.key !== "Enter") return;
  const msg = e.target.value;
  chatLog.innerHTML += `<div>ğŸ‘¦ï¼š${msg}</div>`;
  chatRecord.innerHTML += `<p>ğŸ‘¦ï¼š${msg}</p>`;
  e.target.value = "";

  const res = await fetch("https://dashscope.aliyuncs.com/api/v1/apps/"+APP_ID+"/completion",{
    method:"POST",
    headers:{
      "Authorization":"Bearer "+API_KEY,
      "Content-Type":"application/json"
    },
    body:JSON.stringify({
      input:{ prompt: msg }
    })
  });

  const data = await res.json();
  const reply = data.output.text || "æˆ‘æ¥å¸®ä½ ä¸€èµ·æƒ³æƒ³å§ï¼";
  chatLog.innerHTML += `<div>ğŸ¤–ï¼š${reply}</div>`;
  chatRecord.innerHTML += `<p>ğŸ¤–ï¼š${reply}</p>`;
}

function exportPDF(){
  html2canvas(document.getElementById("content")).then(canvas=>{
    const pdf = new jspdf.jsPDF("p","mm","a4");
    const img = canvas.toDataURL("image/png");
    pdf.addImage(img,"PNG",0,0,210,0);
    pdf.save("æˆ‘çš„ç”µå­è´ºå¡å­¦ä¹ å•.pdf");
  });
}
</script>

</body>
</html>
